import React, { useState } from 'react'; import axios from 'axios'; const API='http://localhost:4000'; export default function BankingPage(){ const [ship,setShip]=useState('R002'); const [year,setYear]=useState(2024); const [result,setResult]=useState<any|null>(null); async function compute(){ try{ const r=await axios.get(`${API}/compliance/cb?shipId=${ship}&year=${year}`); setResult(r.data); }catch(e){ alert('Error computing CB') } } async function bank(){ if(!result) return; try{ await axios.post(`${API}/banking/bank`, { shipId: ship, year, amountGco2eq: Math.max(0, result.cbG) }); alert('Banked'); }catch(e:any){ alert('Error: ' + (e?.response?.data?.error || e.message)); } } return (<div><h2 className='text-xl font-semibold mb-2'>Banking</h2><div className='mb-2'>Ship: <input className='border px-2' value={ship} onChange={e=>setShip(e.target.value)} /> Year: <input className='border px-2' value={year} onChange={e=>setYear(Number(e.target.value))} type='number' /></div><div className='mb-2'><button className='px-3 py-1 bg-blue-600 text-white rounded' onClick={compute}>Compute CB</button></div>{result && <div>CB (g): {Math.round(result.cbG)} ; CB (t): {result.cbTonnes.toFixed(3)}</div>} {result && <div className='mt-2'><button className='px-3 py-1 bg-green-600 text-white rounded' onClick={bank}>Bank positive CB</button></div>}</div>) }
